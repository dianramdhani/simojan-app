<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Dashboard</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <ion-card>
    <ion-card-header>
      <ion-card-title>Setup Device</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <form [formGroup]="formSetupDevice">
        <ion-list *ngIf="listBluetoothObs | async as listBluetooth">
          <ion-item>
            <ion-label position="stacked">Select Bluetooth</ion-label>
            <ion-select interface="action-sheet" formControlName="bluetooth">
              <ion-select-option *ngFor="let bluetooth of listBluetooth" [value]="bluetooth">
                {{ bluetooth.name }} - {{ bluetooth.address }}
              </ion-select-option>
            </ion-select>
          </ion-item>
          <ion-button expand="block" type="submit" [disabled]="!formSetupDevice.valid" (click)="connect()">
            Connect
          </ion-button>
          <ion-button expand="block" type="submit" color="danger" (click)="disconnect()">
            Disconnect
          </ion-button>
        </ion-list>
      </form>
    </ion-card-content>
  </ion-card>

  <ion-card>
    <ion-card-header>
      <ion-card-title>Start/Stop Survey</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ion-button expand="block" (click)="start()">Start</ion-button>
      <ion-button expand="block" color="danger" (click)="stop()">Stop</ion-button>
    </ion-card-content>
  </ion-card>

  <ion-card *ngIf="dataSurveyObs | async as dataSurvey; else noDataSurvey">
    <ion-card-header>
      <ion-card-title>Survey Running</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ion-list>
        <ion-item>
          <ion-label>Time</ion-label>
          <ion-text>{{ dataSurvey.ts }}</ion-text>
        </ion-item>
        <ion-item>
          <ion-label>Accelerometer</ion-label>
          <ion-text>{{ dataSurvey.acc }}</ion-text>
        </ion-item>
        <ion-item>
          <ion-label>Internet Connection</ion-label>
          <ion-text>{{ dataSurvey.conn }}</ion-text>
        </ion-item>
        <ion-item>
          <ion-label>GPS Latitude</ion-label>
          <ion-text>{{ dataSurvey.gps.lat }}</ion-text>
        </ion-item>
        <ion-item>
          <ion-label>GPS Longitude</ion-label>
          <ion-text>{{ dataSurvey.gps.lng }}</ion-text>
        </ion-item>
      </ion-list>
    </ion-card-content>
  </ion-card>
</ion-content>

<ng-template #noDataSurvey>
  <ion-card>
    <ion-card-header>
      <ion-card-title>No Data Survey</ion-card-title>
    </ion-card-header>
  </ion-card>
</ng-template>